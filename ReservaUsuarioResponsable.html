<template x-if="pantalla=='ReservaUsuarioResponsable'">
    <div x-data="ReservaUsuarioResponsable()">
        <div class="container">
            <div class="d-flex justify-content-between mb-3">
                <div>
                    <button class="btn-atras" @click="regresar_pantalla()">
                        <i class="fa-solid fa-circle-arrow-left"></i>
                        <strong>Atrás</strong>
                    </button>
                </div>
                <div>
                    <h5> Responsable de embarcación </h5>
                </div>
                <div></div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="form-group">
                        <label class="f-9">Nombre/s*:</label>
                        <input class="form-control" maxlength="40" x-model="form_reserva.nombre">
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="form-group">
                        <label class="f-9">Apellido/s*:</label>
                        <input class="form-control" maxlength="40" x-model="form_reserva.apellido">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12 mb-4">
                    <div class="form-group">
                        <label class="f-9">Dirección/Ciudad*:</label>
                        <input class="form-control" maxlength="40" x-model="form_reserva.direccion">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="form-group">
                        <label class="f-9">Telefono*:</label>
                        <input class="form-control" maxlength="20" x-model="form_reserva.telefono">
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="form-group">
                        <label class="f-9">Email*:</label>
                        <input class="form-control" maxlength="40" x-model="form_reserva.email">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="form-group d-flex flex-column">
                        <label class="f-9">¿Quieres crear una cuenta con los datos ingresados?</label>
                        <div class="d-flex">
                            <div class="me-4">
                                <input type="radio" name="crear_cuente" value="si_cuenta" id="si_cuenta" class="me-1"
                                    x-model="form_reserva.crear_cuenta">
                                <label for="si_cuenta" class="f-9"> Si </label>
                            </div>
                            <div class="me-4">
                                <input type="radio" name="crear_cuente" value="no_cuenta" id="no_cuenta" class="me-1"
                                    x-model="form_reserva.crear_cuenta">
                                <label for="no_cuenta" class="f-9"> No </label>
                            </div>
                            <div class="me-4">
                                <input type="radio" name="crear_cuente" value="quizas_cuenta" id="quizas_cuenta"
                                    class="me-1" x-model="form_reserva.crear_cuenta">
                                <label for="quizas_cuenta" class="f-9"> Quizás después </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <label class="form-label f-9" for="">Crea una contraseña</label>
                    <input class="form-control" type="password">
                </div>
                <div class="col-md-4">
                    <label class="form-label f-9" for="">Repite la contraseña</label>
                    <input class="form-control" type="password">
                </div>
            </div>

            <hr class="my-4">

            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="form-group">
                        <label class="f-9">Dispone de titulación requerida:</label>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group d-flex">
                        <input type="radio" name="titulacion" value="titulado" id="no_tengo" class="me-1"
                            x-model="form_reserva.titulado">
                        <label for="no_tengo" class="f-9"> No tengo titulo </label>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group d-flex">
                        <input type="radio" name="titulacion" value="no_titulado" id="si_tengo" class="me-1"
                            x-model="form_reserva.titulado">
                        <label for="si_tengo" class="f-9"> Si tengo titulo </label>
                    </div>
                </div>
            </div>

            <div class="container-fluid bg-yellow-light f-9 px-5 py-3 d-flex mb-4">
                <div class="me-2">
                    <button class="btn-icon-red mt-sm07"><i class="fa-solid fa-triangle-exclamation fa-lg"></i></button>
                </div>
                <div>
                    <p class="f-9 m-0">
                        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsum provident eveniet rerum corrupti
                        cupiditate, consectetur, nostrum, magnam animi voluptas nobis quas eos soluta sunt dignissimos
                        laborum
                        facere minima ducimus! Ipsum, iure deserunt ipsam aliquam magni totam quaerat quisquam
                        voluptates quo?
                    </p>
                </div>
            </div>

            <div class="row align-items-center mb-3">
                <div class="col-md-4 d-flex flex-column">
                    <div>
                        <label class="form-label f-9" for=""></label>
                        <div class="btn btn-transparent col-12 col-md-12 col-lg-6 col-xl-3 my-4 text-start"
                            id="preview-archivo" style="width:20rem;">
                            <div class="container" id="image-driver">
                                <label class="form-label f-9" for="">Foto del título:</label>
                                <div
                                    class="container rounded d-flex flex-column justify-content-start align-items-center border-dotted p-4">
                                    <button type="button" class="btn btn-transparent icon-gray"><i
                                            class="fas fa-address-card font-32"></i></button>
                                    <span class="color-gray f-9">Cuelga tu imagen aquí o</span>
                                    <span class="color-blue f-9"><b>Descarga desde tu dispositivo</b></span>
                                    <span class="icon-gray f-8">Máximo 1234 x 1234 px</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex">
                        <span class="f-9 color-gray-responsable">Última foto subida - 12/21/22 13:43 </span>
                        <button class="btn-icon-gray"><i class="fa-solid fa-address-card fa-xl"></i></button>
                        <button class="btn-icon-red"><i class="fa-solid fa-trash-can"></i></button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="container-fluid bg-yellow-light f-9 px-5 py-3 d-flex mb-4">
                        <div class="me-2">
                            <button class="btn-icon-red mt-sm07"><i class="fa-solid fa-triangle-exclamation fa-lg"></i></button>
                        </div>
                        <div>
                            <p>
                                Lorem ipsum dolor sit amet consectetur adipisicing elit. Nisi ab vel possimus cupiditate.
                                Expedita illum facere esse magni. Sint saepe optio delectus cupiditate a totam ratione eligendi
                                iure quidem illo.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label class="f-9">Tipo de doc.:</label>
                    <select class="form-select" x-model="form_reserva.tipo_doc">
                        <option value='DNI'>DNI</option>
                    </select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label class="f-9">Número ID:</label>
                    <input type="text" name="numeroId" id="numeroId" class="form-control"
                        x-model="form_reserva.num_dni">
                </div>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-12 d-flex flex-column">
                <div>
                    <button type="button" class="btn btn-transparent d-flex d-none shadow-none" id="btn-preview">
                        <img class="my-4 ms-3" id="blah" alt="Tu imagen" style="width: 24rem; height: 14rem;" />
                    </button>
        
                    <div class="btn btn-transparent col-12 col-md-12 col-lg-6 col-xl-3 my-4 text-start" id="preview-archivo"
                        style="width:20rem;">
                        <div class="container" id="image-driver">
                            <label class="form-label f-9" for="">Foto de documento*:</label>
                            <div
                                class="container rounded d-flex flex-column justify-content-start align-items-center border-dotted p-4">
                                <button type="button" class="btn btn-transparent icon-gray"><i
                                        class="fas fa-address-card font-32"></i></button>
                                <span class="color-gray f-9">Cuelga tu imagen aquí o</span>
                                <span class="color-blue f-9"><b>Descarga desde tu dispositivo</b></span>
                                <span class="icon-gray f-8">Máximo 1234 x 1234 px</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="d-flex">
                        <span class="f-9 color-gray-responsable">Última foto subida - 12/21/22 13:43 </span>
                        <button class="btn-icon-gray"><i class="fa-solid fa-address-card fa-xl"></i></button>
                        <button class="btn-icon-red"><i class="fa-solid fa-trash-can"></i></button>
                    </div>
                </div>
            </div>

            <div class="col-md-12">
                <div class="form-group">
                    <input type="file" name="archivo" id="archivo" class="d-none" accept="image/*">
                </div>
            </div>
        </div>
        <div class="row mb-2">
            <div class="col-md-12">
                <div class="form-group d-flex">
                    <input class="me-3" type="checkbox" name="aleta_email" id="aleta_email"
                        x-model="form_reserva.alert_email" class="">
                    <label class="f-9" for="aleta_email">Deseo recibir una alerta en mi email llegando el dia de
                        la reserva</label>
                </div>
            </div>
        </div>
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="form-group d-flex">
                    <input type="checkbox" name="aleta_whatsapp" id="aleta_whatsapp"
                        x-model="form_reserva.alert_whatsapp" class="me-3">
                    <label class="f-9" for="aleta_whatsapp">Deseo recibir una alerta en mi whatsApp llegando el
                        dia de la reserva</label>
                </div>
            </div>
        </div>
        <button class="btn btn-blue" @click="val_store()">
            <span> Siguiente </span>
            <i class="fas fa-arrow-alt-circle-right"></i>
        </button>

    </div>
    </div>
    </div>
</template>

<script>
    function ReservaUsuarioResponsable() {
        return {
            init() {
                // alert('llego a usuario')
            },
            val_store() {
                this.form_reserva.image = $('#blah').attr('src');
                let url = this.base_url + '/reserva/val_store_user_reserva'
                axios.post(url, this.form_reserva).then(res => {
                    this.form_resumen.responsable = this.form_reserva.nombre
                    this.pantalla = 'ReservaUsuarioAsistencia'
                }).catch(errors => {
                    var error = Object.values(errors.response.data.errors)[0][0];
                    Swal.fire('Error', error, 'error')
                })
            },
            regresar_pantalla() {
                this.form_reserva.nombre = ''
                this.form_reserva.apellido = ''
                this.form_reserva.direccion = ''
                this.form_reserva.telefono = ''
                this.form_reserva.email = ''
                this.form_reserva.num_dni = ''
                this.form_reserva.image = ''
                this.form_reserva.alert_email = ''
                this.form_reserva.alert_whatsapp = ''
                this.form_reserva.tipo_doc = ''
                this.form_reserva.tutilado = ''
                this.form_resumen.responsable = ''
                this.pantalla = 'ReservaUsuarioHoras'
            }
        }
    }
</script>

<script>
    $('body').on('click', '#preview-archivo', function () {
        $('#archivo').trigger('click')
    })

    $('body').on('click', '#btn-preview', function () {
        $('#archivo').trigger('click')
    })

    function readImage(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah').attr('src', e.target.result); // Renderizamos la imagen
                console.log('this.form_reserva.image ==> ', this.form_reserva.image);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    $('body').on('change', '#archivo', function () {
        readImage(this);
        $('#blah').removeClass('d-none')
        $('#preview-archivo').addClass('d-none')
        $('#btn-preview').removeClass('d-none')
    })
</script>