<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://unpkg.com/vue@3"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
<div id="app">
    <div class="px-md-5" id="home_reserva">
        <div class="d-flex justify-content-center align-items-center">
            <!-- <div>
                <button class="btn btn-transparent color-extras-gray"> <i
                        class="fa-solid fa-angle-left color-dark-blue fa-lg me-3"></i> <span>Agosto 2022</span>
                </button>
            </div> -->
            <div>

                <!-- <h4 class="text-center mt-3 color-dark-blue"> <b> Septiembre 2022 </b> </h4> -->
                <h4 class="text-center mt-3 color-dark-blue"> <b> </b> </h4>
                <!-- <h4 class="text-center mt-3 color-dark-blue"> <b>  echo $date </b> </h4> -->
            </div>
            <!-- <div>
                <button class="btn btn-transparent color-extras-gray"> <span>Octubre 2022</span> <i
                        class="fa-solid fa-angle-right color-dark-blue fa-lg ms-3"></i> </button>
            </div> -->
        </div>
        <hr>

        <div class="d-flex justify-content-end mt-3">
            <button class="btn btn-blue-reserva me-5" id="button-reserva-home"><span class="">Nueva Reserva</span> <i class="fa-solid fa-circle-arrow-right"></i> </button>
        </div>

        <div class="row mt-3">
            <div class="col-12 col-lg-7 col-xl-7">
                <div class="d-flex justify-content-between">
                    <button class="btn btn-transparent">
                        <i class="fa-solid fa-square color-blue"></i>
                        <span class="color-dark-extras">Fecha Reservada</span>
                    </button>
                    <button class="btn btn-transparent color-light-blue">
                        <i class="fa-solid fa-square"></i>
                        <span class="color-dark-extras">Fecha Bloqueada Parcialmente</span></button>
                    <button class="btn btn-transparent color-dark-red">
                        <i class="fa-solid fa-triangle-exclamation me-2"></i>
                        <span>No hay suficiente personal para cubrir todos los turnos del día</span>
                    </button>
                </div>
            </div>
            <div class="col-12 col-lg-1 col-xl-2"></div>
            <div class="col-12 col-lg-4 col-xl-3">
                <div class="d-flex justify-content-between">
                    <form method="POST" action="">
                        <input type="date" class="select-gray form-control me-3" v-model="filter.date" @change="getResults()" />
                        <button type="submit" class="d-none" id="submit-date-button"></button>
                    </form>
                    <!-- <select class="select-gray form-select me-3" name="" id="">
                        <option value="">Ver todos los barcos</option>
                    </select> -->
                    <button class="btn bg-dark-blue color-white w-3rem me-3">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <button class="btn bg-dark-blue color-white w-3rem">
                        <i class="fa-solid fa-calendar-days"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="contaner-fluid mt-4">
            <div class="table-responsive mb-5">
                <table class="table table-bordered text-center">
                    <thead>
                        <tr>
                            <td></td>
                            <td v-for="(i, index) in table.horas_array" :key="index"> {{ i }}</td>
                            <td>Cierre</td>
                        </tr>
                        <tr v-for="(i, index) in table.reservas" :key="index" class="recorrido-bote">
                            <td>{{ i.nombre }}</td>
                            <td v-for="(hour, key) in i.horas" :key="key" v-bind:class="[hour == 1 || hour == 2 || hour == 3 ? 'recorrido-bote-td' : '']">
                                        <button class="btn btn-transparent color-dark-blue button-ellipsis btn-ellipsis-script" v-if="hour == 3">
                                            <i class="fa-solid fa-ellipsis button-ellipsis"></i></button>
                                        <button v-if="hour == 3" class="btn btn-transparent color-dark-blue"><i class="fa-solid fa-flag-checkered"></i>  </button>
                                        <button v-else-if="hour == 1 || hour == 2" class="btn btn-transparent color-dark-blue">
                                                <i v-if="hour == 1" class="fa-solid fa-sailboat"></i>
                                                <i v-if="hour == 2" class="fa-solid fa-hand-sparkles"></i>
                                        </button>
                            </td>
                            <td>
                                <button class="btn btn-transparent color-dark-blue"> <i class="fa-solid fa-power-off"></i> </button>
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script>
    var {
        createApp
    } = Vue

    createApp({
        data() {
            return {
                count: 0,
                message: 'Hello Vue!',
                table: {horas_array: [], reservas: []},
                filter: {date: ''},
                days: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado']
            }
        },
        mounted() {
            this.getResults()
        },
        methods: {
            getResults() {
                console.log('date ==> ', this.filter.date)
                let url = 'https://rutaapp.com/boats/wp-content/themes/twentytwentytwo/logica.php'
                url += '?date='+this.filter.date
                axios.get(url).then(res => {
                    this.table.horas_array = res.data.horas_array
                    this.table.reservas = res.data.reservas
                })
            }
        },
    }).mount('#app')
</script>